function snakesAndLadders(board: number[][]): number {
    const N = board.length
    const last = N * N

    const graph: Set<number>[] = []

    const idx_to_row_col = (idx: number): [ number, number ] => {
        const row = Math.floor(idx / N)
        const is_rtl = row % 2 === 0

        return [ N - 1 - row, is_rtl ? idx % N : N - 1 - (idx % N) ]
    }

    for (let row = N - 1; row >= 0; row--) {
        for (let col = 0; col < N; col++) {
            const is_rtl = (N - row) % 2 === 1
            const idx = (N - row - 1) * N + (is_rtl ? col : N - col - 1)

            const tos: Set<number> = new Set()

            for (let i = idx + 1; i < last && i <= idx + 6; i++) {
                const [r, c] = idx_to_row_col(i)

                const dest = board[r][c]

                if (dest === -1) {
                    tos.add(i)
                }
                else {
                    tos.add(dest - 1)
                }
            }

            graph[idx] = tos
        }
    }

    const paths = new Array<number>(last).fill(Infinity)
    paths[0] = 0

    let froms = [ 0 ]

    while (froms.length) {
        let froms2: number[] = []

        for (let i = 0; i < froms.length; i++){
            const from = froms[i]

            const tos = graph[ from ]

            for (const t of tos) {
                const path_to = paths[from] + 1

                if (paths[t] > path_to) {
                    paths[t] = path_to

                    if (t === last - 1) {
                        froms2 = []
                        break
                    }

                    froms2.push(t)
                }
            }
        }

        froms = froms2
    }

    return paths[last - 1] === Infinity ? -1 : paths[last - 1]
};

console.log(
    snakesAndLadders(
        // [
        //     [-1, -1, -1, -1],
        //     [-1, -1, -1, -1],
        //     [-1, -1, -1, -1],
        //     [-1, 14, -1, -1],
        // ]
[[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]]
    )
)